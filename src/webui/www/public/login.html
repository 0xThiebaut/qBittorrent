<!DOCTYPE html>
<html lang="${LANG}">

<head>
    <meta charset="UTF-8" />
    <title>qBittorrent QBT_TR(Web UI)QBT_TR[CONTEXT=OptionsDialog]</title>
    <link rel="icon" type="image/png" href="images/skin/qbittorrent32.png" />
    <link rel="stylesheet" type="text/css" href="css/login.css?v=${VERSION}" />
    <noscript>
        <link rel="stylesheet" type="text/css" href="css/noscript.css?v=${VERSION}" />
    </noscript>
    <script>
        'use strict';

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('username').focus();
            document.getElementById('username').select();

            document.getElementById('loginform').addEventListener('submit', function(e) {
                e.preventDefault();
            });
        });

        function submitLoginForm() {
            var errorMsgElement = document.getElementById('error_msg');

            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'api/v2/auth/login', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded; charset=utf-8');
            xhr.addEventListener('readystatechange', function() {
                if (xhr.readyState === 4) {  // DONE state
                    if ((xhr.status === 200) && (xhr.responseText === "Ok."))
                        location.reload(true);
                    else
                        errorMsgElement.innerHTML = 'QBT_TR(Invalid Username or Password.)QBT_TR[CONTEXT=HttpServer]';
                }
            });
            xhr.addEventListener('error', function() {
                errorMsgElement.innerHTML = (xhr.responseText !== "")
                    ? xhr.responseText
                    : 'QBT_TR(Unable to log in, qBittorrent is probably unreachable.)QBT_TR[CONTEXT=HttpServer]';
            });

            var usernameElement = document.getElementById('username');
            var passwordElement = document.getElementById('password');
            var queryString = "username=" + encodeURIComponent(usernameElement.value) + "&password=" + encodeURIComponent(passwordElement.value);
            xhr.send(queryString);

            // clear the field
            passwordElement.value = '';
        }
    </script>
</head>

<body>
    <noscript id="noscript">
        <h1>QBT_TR(JavaScript Required! You must enable JavaScript for the Web UI to work properly)QBT_TR[CONTEXT=HttpServer]</h1>
    </noscript>
    <div id="main">
        <h1>qBittorrent QBT_TR(Web UI)QBT_TR[CONTEXT=OptionsDialog]</h1>
        <div id="logo" class="col">
            <img src="images/skin/qbittorrent-tray.svg" alt="qBittorrent logo" />
        </div>
        <div id="formplace" class="col">
            <form id="loginform" method="post" onsubmit="submitLoginForm();">
                <div class="row">
                    <label for="username">QBT_TR(Username)QBT_TR[CONTEXT=HttpServer]</label><br />
                    <input type="text" id="username" name="username" autocomplete="username" /></div>
                <div class="row">
                    <label for="password">QBT_TR(Password)QBT_TR[CONTEXT=HttpServer]</label><br />
                    <input type="password" id="password" name="password" autocomplete="current-password" /></div>
                <div class="row">
                    <input type="submit" id="login" value="QBT_TR(Login)QBT_TR[CONTEXT=HttpServer]" />
                </div>
            </form>
        </div>
        <div id="error_msg"></div>
    </div>
</body>

</html>
